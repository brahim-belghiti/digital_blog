---
import { getCollection } from 'astro:content';
import Container from '@components/Container.astro';
import PageLayout from '@layouts/PageLayout.astro';
import ArrowCard from '@components/ArrowCard.astro';
import Link from '@components/common/Link.astro';
import { SITE, HOME, SOCIALS } from '@consts';

interface ProjectEntry {
  data: {
    title: string;
    description: string;
    date: Date;
    demoURL?: string;
    image?: string;
    draft?: boolean;
    tags?: string[];
  };
  slug: string;
}

const blog = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_POSTS_ON_HOMEPAGE);

const projects = (await getCollection('projects'))
  .filter((project) => !project.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_PROJECTS_ON_HOMEPAGE) as ProjectEntry[];
---

<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <section
      class="relative overflow-hidden py-12 md:py-20 mb-16 rounded-2xl bg-gradient-to-br from-orange-50 to-slate-100 dark:from-gray-900 dark:to-gray-800"
    >
      <div class="absolute inset-0 z-0 opacity-30">
        <div class="grid-background"></div>
      </div>

      <div class="relative z-10 px-6 md:px-10 max-w-4xl mx-auto">
        <div class="slide-in-left">
          <div
            class="inline-block px-4 py-1.5 mb-6 text-sm rounded-full bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-300 font-medium"
          >
            Frontend Developer
          </div>
        </div>

        <h1
          class="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 slide-in-left"
          style="animation-delay: 100ms"
        >
          Hi, I'm Brahim Belghiti <span class="animate-wave inline-block"
            >üëãüèª</span
          >
        </h1>

        <p
          class="text-xl md:text-2xl text-gray-700 dark:text-gray-300 max-w-2xl slide-in-left"
          style="animation-delay: 200ms"
        >
          A Front End developer passionate about design, solving problems and
          building stuff. Working with ReactJs, Nextjs, and TypeScript.
        </p>

        <div
          class="mt-8 flex flex-wrap gap-4 slide-in-left"
          style="animation-delay: 300ms"
        >
          <a
            href="#projects"
            class="px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg hover:translate-y-[-2px]"
          >
            View Projects
          </a>
        </div>
      </div>

      <div
        class="absolute bottom-0 right-0 w-64 h-64 translate-x-1/4 translate-y-1/4 rounded-full bg-orange-300/20 dark:bg-orange-700/20 blur-3xl"
      >
      </div>
      <div
        class="absolute top-0 left-0 w-32 h-32 -translate-x-1/4 -translate-y-1/4 rounded-full bg-w-300/20 dark:bg-w-700/20 blur-3xl"
      >
      </div>
    </section>

    <div class="space-y-24">
      <section class="animate-fade-in-up space-y-6">
        <div class="flex items-center justify-between mb-8">
          <div class="flex items-center gap-3">
            <div class="w-1.5 h-8 bg-orange-500 rounded-full"></div>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
              Latest Posts
            </h2>
          </div>
          <Link
            href="/blog"
            style="group flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
          >
            See all posts
            <span
              class="transform transition-transform duration-300 group-hover:translate-x-1"
              >‚Üí</span
            >
          </Link>
        </div>

        <ul class="grid grid-cols-1 md:grid-cols-2 gap-6">
          {
            blog.map((post, index) => (
              <li
                class="fade-in-up"
                style={`animation-delay: ${index * 100}ms`}
              >
                <ArrowCard entry={post} />
              </li>
            ))
          }
        </ul>
      </section>

      <section class="animate-fade-in-up space-y-6" id="projects">
        <div class="flex items-center justify-between mb-8">
          <div class="flex items-center gap-3">
            <div class="w-1.5 h-8 bg-orange-500 rounded-full"></div>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
              Recent Projects
            </h2>
          </div>
          <Link
            href="/projects"
            style="group flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
          >
            See all projects
            <span
              class="transform transition-transform duration-300 group-hover:translate-x-1"
              >‚Üí</span
            >
          </Link>
        </div>

        {
          projects.length > 0 ? (
            <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
              {projects.map((project, index) => (
                <li
                  class="project-card"
                  style={`animation-delay: ${index * 150}ms`}
                >
                  <a
                    href={`/projects/${project.slug}`}
                    class="group block h-full rounded-xl overflow-hidden bg-white dark:bg-gray-800 transition-all duration-300 shadow-lg hover:shadow-xl"
                    aria-label={`View details for ${project.data.title}`}
                  >
                    <div class="relative overflow-hidden aspect-video">
                      {project.data.image ? (
                        <img
                          src={project.data.image}
                          alt={`${project.data.title} thumbnail`}
                          class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                        />
                      ) : (
                        <div class="w-full h-full bg-gradient-to-br from-orange-500/70 to-purple-600/70 flex items-center justify-center">
                          <span class="text-3xl font-bold text-white">
                            {project.data.title.charAt(0)}
                          </span>
                        </div>
                      )}
                    </div>

                    <div class="p-6">
                      <h3 class="font-bold text-xl text-gray-900 dark:text-white mb-3 group-hover:text-orange-600 dark:group-hover:text-orange-400 transition-colors">
                        {project.data.title}
                      </h3>

                      <p class="text-gray-600 dark:text-gray-300 line-clamp-3 mb-4 text-sm">
                        {project.data.description}
                      </p>

                      {project.data?.tags && (
                        <div class="flex flex-wrap gap-2 mt-auto pt-2 border-t border-gray-100 dark:border-gray-700">
                          {project.data?.tags.slice(0, 3).map((tag) => (
                            <span class="text-xs bg-gray-100 dark:bg-gray-700 px-2.5 py-1 rounded-full text-gray-700 dark:text-gray-300">
                              {tag}
                            </span>
                          ))}
                        </div>
                      )}
                    </div>
                  </a>
                </li>
              ))}
            </ul>
          ) : (
            <div class="text-center py-20 bg-gray-50 dark:bg-gray-800/50 rounded-xl">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-16 h-16 mx-auto text-gray-400 mb-4"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
                />
              </svg>
              <p class="text-gray-600 dark:text-gray-400 text-lg">
                No projects available. Check back soon!
              </p>
            </div>
          )
        }
      </section>

      <section
        class="animate-fade-in-up space-y-6 rounded-2xl bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800 p-8 md:p-10"
      >
        <div class="flex items-center gap-3 mb-6">
          <div class="w-1.5 h-8 bg-orange-500 rounded-full"></div>
          <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
            Let's Connect
          </h2>
        </div>

        <div class="max-w-2xl mb-8">
          <p class="text-lg text-gray-700 dark:text-gray-300">
            If you want to get in touch with me about something or just to say
            hi, reach out on social media or send me an email.
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          {
            SOCIALS.map((SOCIAL, index) => (
              <a
                href={SOCIAL.HREF}
                target="_blank"
                rel="noopener noreferrer"
                class="social-link flex items-center gap-3 p-4 rounded-lg bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 transition-all duration-200 hover:shadow-md"
                style={`animation-delay: ${index * 100}ms`}
                aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}
              >
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400">
                  {SOCIAL.NAME.charAt(0)}
                </div>
                <span class="font-medium text-gray-900 dark:text-white">
                  {SOCIAL.NAME}
                </span>
              </a>
            ))
          }

          <a
            href={`mailto:${SITE.EMAIL}`}
            class="w-max social-link flex items-center gap-3 p-4 rounded-lg bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 transition-all duration-200 hover:shadow-md"
            style={`animation-delay: ${SOCIALS.length * 100}ms`}
            aria-label={`Email ${SITE.NAME}`}
          >
            <div
              class="flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                ></path>
              </svg>
            </div>
            <span
              class="font-medium text-gray-900 dark:text-white overflow-hidden "
              >{SITE.EMAIL}</span
            >
          </a>
        </div>
      </section>
    </div>
  </Container>
</PageLayout>

<style>
  /* Base animations */
  .animate-fade-in-up {
    opacity: 0;
    animation: fadeInUp 0.8s ease-out forwards;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-wave {
    animation: wave 2.5s infinite;
    transform-origin: 70% 70%;
    display: inline-block;
  }

  @keyframes wave {
    0% {
      transform: rotate(0deg);
    }
    10% {
      transform: rotate(14deg);
    }
    20% {
      transform: rotate(-8deg);
    }
    30% {
      transform: rotate(14deg);
    }
    40% {
      transform: rotate(-4deg);
    }
    50% {
      transform: rotate(10deg);
    }
    60% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(0deg);
    }
  }

  /* Project cards animation */
  .project-card {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s ease-out forwards;
  }

  /* Slide in animations */
  .slide-in-left {
    opacity: 0;
    transform: translateX(-50px);
    animation: slideInLeft 0.7s ease-out forwards;
  }

  @keyframes slideInLeft {
    from {
      opacity: 0;
      transform: translateX(-50px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Social links animation */
  .social-link {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.6s ease-out forwards;
  }

  /* Continuous animation for background elements */
  .fade-in-up {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.7s ease-out forwards;
  }

  /* Grid background */
  .grid-background {
    background-size: 40px 40px;
    background-image: linear-gradient(
        to right,
        rgba(0, 0, 0, 0.05) 1px,
        transparent 1px
      ),
      linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
    width: 100%;
    height: 100%;
  }

  /* Dark mode grid background */
  :global(.dark) .grid-background {
    background-image: linear-gradient(
        to right,
        rgba(255, 255, 255, 0.05) 1px,
        transparent 1px
      ),
      linear-gradient(to bottom, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
  }
</style>
